<div class="bg-white rounded-lg shadow-lg p-6">
  <div *ngIf="estimation" class="flex items-center gap-3 mb-4 pb-4 border-b border-gray-200">
    <span 
      class="w-10 px-2 py-1 text-sm font-bold rounded shrink-0 text-center"
      [ngClass]="[getTShirtSize().bgColor, getTShirtSize().textColor]"
    >
      {{ getTShirtSize().size }}
    </span>
    <h2 class="text-xl font-bold text-gray-800">{{ estimation.name }}</h2>
    <span class="px-2 py-1 text-xs font-medium rounded bg-gray-100 text-gray-600 shrink-0">
      {{ getComplexityPointsCeil() }} pts
    </span>
  </div>
  <div class="relative flex items-center justify-center -my-10" style="height: 500px;">
    <canvas #chartCanvas></canvas>
  </div>
  <!-- R√©sum√© global compact -->
  <div *ngIf="estimation" class="mt-2 p-3 rounded-lg border border-gray-100 bg-white">
    <!-- √âchelle T-shirt sizes -->
    <div class="flex items-center justify-center gap-1 mb-2">
      <ng-container *ngFor="let tshirt of tShirtSizes">
        <div class="w-8 px-1.5 py-0.5 rounded text-center transition-all text-[10px]"
             [ngClass]="getTShirtSize().size === tshirt.size 
               ? [tshirt.bgColor, tshirt.textColor, 'font-bold', 'ring-1', 'ring-offset-1'] 
               : 'bg-gray-100 text-gray-400'">
          {{ tshirt.size }}
        </div>
      </ng-container>
    </div>
    <div class="flex items-center gap-4">
      <div class="flex items-center gap-2">
        <span class="w-14 text-2xl font-black px-2 py-0.5 rounded text-center" [ngClass]="[getTShirtSize().bgColor, getTShirtSize().textColor]">
          {{ getTShirtSize().size }}
        </span>
        <div class="text-xs text-gray-500">{{ getTShirtSize().min }}-{{ getTShirtSize().max }} pts</div>
      </div>
      <div class="flex-1">
        <div class="h-2 bg-gray-100 rounded-full overflow-hidden">
          <div class="h-full transition-all duration-500 rounded-full"
               [ngClass]="getTShirtProgressClass()"
               [style.width.%]="getCurseAverage()">
          </div>
        </div>
      </div>
      <div class="text-right">
        <span class="text-lg font-bold text-gray-800">{{ getComplexityPointsCeil() }}</span>
        <span class="text-xs text-gray-500 ml-1">pts</span>
      </div>
    </div>
    <p class="mt-2 text-[11px] text-gray-500">üí° {{ getOverallDescription() }}</p>
  </div>

  <!-- D√©tail des 5 dimensions CURSE - Compact -->
  <div *ngIf="estimation" class="mt-2 grid grid-cols-5 gap-1.5">
    <!-- Complexity -->
    <div class="p-2 rounded-lg bg-white border border-gray-200">
      <div class="flex items-center gap-1">
        <span class="w-5 h-5 flex items-center justify-center rounded-full bg-yellow-500 text-white text-[10px] font-bold shrink-0">C</span>
        <div class="flex gap-0.5">
          <ng-container *ngFor="let grad of getGraduations('complexity'); let i = index">
            <div class="w-1.5 h-1.5 rounded-full"
                 [ngClass]="i <= getGraduationIndex('complexity') ? 'bg-yellow-500' : 'bg-gray-200'"
                 [title]="grad.label">
            </div>
          </ng-container>
        </div>
      </div>
      <div class="text-center -my-1">
        <span class="text-xs font-semibold text-gray-700">{{ estimation.complexity }}</span>
      </div>
      <div class="text-center">
        <span class="text-[9px] text-gray-400">Complexit√©</span>
      </div>
    </div>

    <!-- Uncertainty -->
    <div class="p-2 rounded-lg bg-white border border-gray-200">
      <div class="flex items-center gap-1">
        <span class="w-5 h-5 flex items-center justify-center rounded-full bg-purple-500 text-white text-[10px] font-bold shrink-0">U</span>
        <div class="flex gap-0.5">
          <ng-container *ngFor="let grad of getGraduations('uncertainty'); let i = index">
            <div class="w-1.5 h-1.5 rounded-full"
                 [ngClass]="i <= getGraduationIndex('uncertainty') ? 'bg-purple-500' : 'bg-gray-200'"
                 [title]="grad.label">
            </div>
          </ng-container>
        </div>
      </div>
      <div class="text-center -my-1">
        <span class="text-xs font-semibold text-gray-700">{{ estimation.uncertainty }}</span>
      </div>
      <div class="text-center">
        <span class="text-[9px] text-gray-400">Incertitude</span>
      </div>
    </div>

    <!-- Risk -->
    <div class="p-2 rounded-lg bg-white border border-gray-200">
      <div class="flex items-center gap-1">
        <span class="w-5 h-5 flex items-center justify-center rounded-full bg-red-500 text-white text-[10px] font-bold shrink-0">R</span>
        <div class="flex gap-0.5">
          <ng-container *ngFor="let grad of getGraduations('risk'); let i = index">
            <div class="w-1.5 h-1.5 rounded-full"
                 [ngClass]="i <= getGraduationIndex('risk') ? 'bg-red-500' : 'bg-gray-200'"
                 [title]="grad.label">
            </div>
          </ng-container>
        </div>
      </div>
      <div class="text-center -my-1">
        <span class="text-xs font-semibold text-gray-700">{{ estimation.risk }}</span>
      </div>
      <div class="text-center">
        <span class="text-[9px] text-gray-400">Risque</span>
      </div>
    </div>

    <!-- Size -->
    <div class="p-2 rounded-lg bg-white border border-gray-200">
      <div class="flex items-center gap-1">
        <span class="w-5 h-5 flex items-center justify-center rounded-full bg-green-500 text-white text-[10px] font-bold shrink-0">S</span>
        <div class="flex gap-0.5">
          <ng-container *ngFor="let grad of getGraduations('size'); let i = index">
            <div class="w-1.5 h-1.5 rounded-full"
                 [ngClass]="i <= getGraduationIndex('size') ? 'bg-green-500' : 'bg-gray-200'"
                 [title]="grad.label">
            </div>
          </ng-container>
        </div>
      </div>
      <div class="text-center -my-1">
        <span class="text-xs font-semibold text-gray-700">{{ estimation.size }}</span>
      </div>
      <div class="text-center">
        <span class="text-[9px] text-gray-400">Taille</span>
      </div>
    </div>

    <!-- Effort -->
    <div class="p-2 rounded-lg bg-white border border-gray-200">
      <div class="flex items-center gap-1">
        <span class="w-5 h-5 flex items-center justify-center rounded-full bg-blue-500 text-white text-[10px] font-bold shrink-0">E</span>
        <div class="flex gap-0.5">
          <ng-container *ngFor="let grad of getGraduations('effort'); let i = index">
            <div class="w-1.5 h-1.5 rounded-full"
                 [ngClass]="i <= getGraduationIndex('effort') ? 'bg-blue-500' : 'bg-gray-200'"
                 [title]="grad.label">
            </div>
          </ng-container>
        </div>
      </div>
      <div class="text-center -my-1">
        <span class="text-xs font-semibold text-gray-700">{{ estimation.effort }}</span>
      </div>
      <div class="text-center">
        <span class="text-[9px] text-gray-400">Effort</span>
      </div>
    </div>
  </div>

  <div *ngIf="!estimation" class="text-center text-gray-500 py-8">
    Aucune estimation s√©lectionn√©e. Utilisez le formulaire √† droite pour cr√©er ou modifier une estimation et voir le diagramme radar se mettre √† jour en temps r√©el.
  </div>
</div>
